---
// 1. Importamos el layout que SÍ maneja la seguridad
import AdminLayout from '@/layouts/AdminLayout.astro';

// 2. Importamos los componentes y utilidades con ALIAS
import { query } from '@/lib/db.js';
import CoachesList from '@/components/admin/CoachesList.jsx';

// 3. Obtenemos los datos (¡esto es lo único que esta página debe hacer!)
interface Coach { id: number; name: string; role: string; }
const sql = "SELECT id, name, role FROM coaches ORDER BY id DESC";
const coaches = await query({ query: sql }) as Coach[];
---

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administración - Entrenadores</title>
</head>
<body>

    <h1>Administrar Entrenadores</h1>
    <a href="/admin/crear-entrenador" class="add-link">Añadir Nuevo Entrenador</a>
    <CoachesList client:load coaches={coaches} />

</body>
</html>

<style>
    body { font-family: Arial, sans-serif; line-height: 1.6; margin: 20px; }
    h1 { color: #333; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
    a { color: #007bff; text-decoration: none; }
    a:hover { text-decoration: underline; }
    .action-links a { margin-right: 10px; }
    .add-link { display: inline-block; margin-top: 20px; padding: 10px 15px; background-color: #28a745; color: white; border-radius: 5px; }
</style>
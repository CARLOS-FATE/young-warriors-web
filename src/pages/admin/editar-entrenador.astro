---
// src/pages/admin/editar-entrenador.astro
import { checkAdminAuth } from "../../../lib/authAdmin.js"; // <-- ¡Usamos nuestro guardia!
import { query } from "../../../lib/db.js";

checkAdminAuth(Astro);

const id = Astro.url.searchParams.get("id");
if (!id) {
    return Astro.redirect("/admin/coaches");
}

const sql = "SELECT * FROM coaches WHERE id = ?";
const [coach] = await query({ query: sql, values: [id] });

if (!coach) {
    return new Response("Entrenador no encontrado.", { status: 404 });
}
---

<!doctype html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <title>Editar Entrenador</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                line-height: 1.6;
                margin: 20px;
            }
            h1 {
                color: #333;
            }
            form {
                max-width: 600px;
                margin-top: 20px;
            }
            /* ... (Copia el resto de tus estilos de editar.php) ... */
        </style>
    </head>
    <body>
        <h1>Editar Entrenador: {coach.name}</h1>

        <form action="/api/admin/editar-entrenador" method="post">
            <input type="hidden" name="id" value={coach.id} />

            <div class="form-group">
                <label for="name">Nombre:</label>
                <input
                    type="text"
                    id="name"
                    name="name"
                    value={coach.name}
                    required
                />
            </div>
            <div class="form-group">
                <label for="role">Rol:</label>
                <input
                    type="text"
                    id="role"
                    name="role"
                    value={coach.role}
                    required
                />
            </div>
            <div class="form-group">
                <label for="bio">Biografía:</label>
                <textarea id="bio" name="bio">{coach.bio}</textarea>
            </div>
            <div class="form-group">
                <label for="quote">Frase:</label>
                <textarea id="quote" name="quote">{coach.quote}</textarea>
            </div>
            <button type="submit">Guardar Cambios</button>
        </form>

        <br />
        <a href="/admin/coaches">Cancelar y volver a la lista</a>
    </body>
</html>
